# MNIST手写数字识别项目

> 注：本项目的所有代码注释和本README文档均由Claude 3.5 (Sonnet)自动生成。

## 项目简介

本项目实现了一个基于PyTorch的MNIST手写数字识别系统。项目采用CNN（卷积神经网络）架构，包含完整的数据处理、模型训练和推理可视化功能。

## 项目结构

```
.
├── data.py      # 数据加载和预处理
├── model.py     # CNN模型架构定义
├── train.py     # 训练流程实现
└── reason.py    # 推理和可视化
```

## 环境要求

- Python 3.x
- PyTorch
- torchvision
- matplotlib
- torchmetrics
- tabulate
- PyQt5

## 核心功能

### 1. 数据处理 (data.py)
- MNIST数据集加载和预处理
- 数据增强（随机旋转、平移、缩放）
- 训练/验证/测试集划分
- 数据可视化功能

### 2. 模型架构 (model.py)
- 3层CNN架构
- 批量归一化层
- Dropout正则化
- 特征提取和分类层

网络结构：
- 输入：28x28 灰度图像
- 卷积层：32 -> 64 -> 128通道
- 全连接层：128特征
- 输出：10分类（数字0-9）

### 3. 训练系统 (train.py)
- 自动GPU/CPU设备选择
- 交叉熵损失函数
- NAdam优化器
- 多重评估指标（准确率、精确率、召回率、F1分数）
- 早停机制
- 最佳模型保存

### 4. 推理系统 (reason.py)
- 随机样本推理
- 实时可视化预测结果
- 显示每个数字的预测概率
- 支持连续推理（按Ctrl+C退出）

## 使用方法

1. 训练模型：
```bash
python train.py
```

2. 运行推理：
```bash
python reason.py
```

## 特色功能

1. 数据增强
- 随机旋转（±15度）
- 随机平移（±20%）
- 随机缩放（0.8-1.2倍）

2. 训练优化
- 早停机制，避免过拟合
- 保存最佳模型
- 完整的评估指标

3. 交互式推理
- 实时可视化
- 概率分布显示
- 支持连续推理

## 模型性能

训练过程中会自动监控和保存：
- 训练损失
- 验证集准确率
- 测试集综合指标

## 注意事项

1. 首次运行会自动下载MNIST数据集
2. 训练过程会生成`best_model.pth`文件
3. 推理时需确保已有训练好的模型文件

## 生成说明

本项目的所有代码注释和本README文档均由Claude 3.5 (Sonnet)生成。生成过程遵循以下原则：
1. 基于代码实现逻辑添加专业且详细的注释
2. 保持注释风格统一性
3. 确保文档的完整性和可读性

---

如有问题或建议，欢迎提出。
